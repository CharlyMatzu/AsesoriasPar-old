<div class="container-fluid">

        <!-- Options -->
        <div class="card col-lg-12">

            <div class="options">
                <button ng-click="showSquare()" class="btn btn-dark" data-toggle="tooltip" title="Mostrar en cuadros"><span class="fa fa-th-large"></span></button>
                <button ng-click="showTable()" class="btn btn-dark" data-toggle="tooltip" title="Mostrar en tabla"><span class="fa fa-list"></span></button>

                <!-- refresh -->
                <button ng-click="getAdvisories()" class="btn btn-primary"><span class="fa fa-refresh"></span> Recargar</button>
            </div>
            
        </div>
        <!-- end options -->

    
        <!-- content square -->
        <div class="card col-lg-12 square" ng-if="showSquareAdvisories">

            <!-- loader -->
            <div class="loader" ng-show="loading">
                <i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i>
            </div>
            
            <div class="card-body" ng-show="!loading">
                <!-- advisories -->
                <div class="advisories-container">
                    <div class="advisories  double">

                        <p ng-show="advisories.length == 0">No hay asesorías registradas</p>
                        
                        <!-- double -->
                        <div class="item item-double" ng-repeat="ad in advisories" data-advisory-id="ad.id">
                        
                            <!-- alumno -->
                            <div class="alumno student-item">
                                <h4 class="title">Alumno</h4>
                                <div class="avatar">
                                    <img ng-show="ad.alumn_id != null" src="../../../../assets/img/student_assign.jpg" alt="">
                                </div>
                                <div class="info">
                                    <div class="name">
                                        <a href="#!/estudiantes/{{ad.alumn_id}}/detalle">{{ad.alumn_first_name}} {{ad.alumn_last_name}}</a>
                                    </div>
                                </div>
                            </div>
                            <!-- end-alumno -->

                            <!-- adviser -->
                            <div class="adviser student-item">
                                <h4 class="title">Asesor</h4>
                                <div class="avatar">
                                    <img ng-show="ad.adviser_id != null" src="../../../../assets/img/teacher_assign.jpg" alt="">
                                    <img ng-show="ad.adviser_id == null" src="../../../../assets/img/teacher_empty.jpg" alt="">
                                </div>
                                <div class="info">
                                    <div class="name" ng-show="ad.adviser_id != null">
                                        <a href="#!/estudiantes/{{ad.adviser_id}}/detalle">{{ad.adviser_first_name}} {{ad.adviser_last_name}}</a>
                                    </div>
                                    <div class="name" ng-show="ad.adviser_id == null">SIN ASESOR</div>
                                </div>
                            </div>
                            <!-- end-adviser -->

                            <div class="info-container">
                                <!-- TODO: agregar enlace a materia -->
                                <div class="subject">
                                    {{ad.subject_name}}
                                </div>

                                <div class="status">
                                    <span ng-show="ad.status === 'PENDING'" class="badge badge-warning">Pendiente</span>
                                    <span ng-show="ad.status === 'ACTIVE'" class="badge badge-success">Activo</span>
                                    <span ng-show="ad.status === 'FINALIZED'" class="badge badge-danger">Finalizado</span>
                                </div>

                                <button class="btn-opt" ng-show="ad.status === 'PENDING' || ad.status == 'ACTIVE'"><span class="fa fa-times"></span> Finalizar</button>
                                <button ng-show="ad.status === 'PENDING'" class="btn-opt opt-success" ng-click="openAssign(ad)"><span class="fa fa-plus"></span> Asignar</button>
                            </div>

                        </div>
                        <!-- end double -->
                    </div>
                </div>
                <!-- end advisories -->
            </div>
        </div>
        <!-- end content square -->



        <!-- advisories table -->
        <div class="card col-lg-12 table" ng-if="showTableAdvisories">

            <!-- loader -->
            <div class="loader" ng-show="loading">
                <i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i>
            </div>

            <div class="card-body" ng-show="!loading">
                <div class="advisories-container advisories-table">

                    <p ng-show="advisories.length == 0">No hay asesorías registradas</p>

                    <div class="table-responsive" ng-show="advisories.length > 0">
                        
                        <table id="table-advisories" class="display nowrap">
                            <thead>
                                <tr>
                                    <th>Alumno</th>
                                    <th>Asesor</th>
                                    <th>Materia</th>
                                    <th>Fecha inicio</th>
                                    <th>Fecha termino</th>
                                    <th>Estado</th>
                                    <!-- <th>Horario</th> -->
                                    <th>Lunes</th>
                                    <th>Martes</th>
                                    <th>Miércoles</th>
                                    <th>Jueves</th>
                                    <th>Viernes</th>
                                    <th>Opciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="ad in advisories">
                                    <td>
                                        <a class="link" href="#!/estudiantes/{{ad.alumn_id}}/detalle">{{ad.alumn_first_name}} {{ad.alumn_last_name}}</a>
                                    </td>
                                    <td>
                                        <a class="link" href="#!/estudiantes/{{ad.adviser_id}}/detalle" ng-if="ad.adviser_id">{{ad.adviser_first_name}} {{ad.adviser_last_name}}</a>
    
                                        <span ng-if="!ad.adviser_id">Sin asesor</span>
                                    </td>
                                    <td>{{ad.subject_name}}</td>
                                    <td>{{ad.date_start}}</td>
                                    <td>{{ad.date_end}}</td>
                                    <td>
                                        <span ng-if="ad.status === 'PENDING'" class="badge badge-warning">Pendiente</span>
                                        <span ng-if="ad.status === 'ACTIVE'" class="badge badge-success">Activo</span>
                                        <span ng-if="ad.status === 'FINALIZED'" class="badge badge-danger">Finalizado</span>
                                    </td>
                                    <!-- Si no hay horas asignadas -->
                                    <td ng-if="ad.schedule.length == 0" ng-repeat="i in getNumber(5) track by $index">
                                        ....
                                    </td>

                                    <!-- Cuando hay horas -->
                                    <td ng-if="ad.schedule.length > 0" ng-repeat="day in ad.schedule">
                                        <span ng-if="!day.hours.length > 0">N/A</span>
                                        <span ng-if="day.hours.length > 0" ng-repeat="hour in day.hours">{{hour.hour}}</span>
                                    </td>


                                    <!-- <td class="table-schedule">
                                        <span class="day" ng-repeat="day in ad.schedule">
                                            <strong>{{day.day}}:</strong>
                                            <span class="hour" ng-repeat="hour in day.hours">{{hour.hour}}</span>
                                        </span>
                                    </td> -->
                                    <!-- <td ng-repeat="day in ad.schedule">
                                        <span ng-if="!day.hours.length > 0">N/A</span>
                                        <span ng-if="day.hours.length > 0" ng-repeat="hour in day.hours">{{hour.hour}}</span>
                                    </td> -->
                                    


                                    <td>
                                        <button class="btn btn-danger" ng-if="ad.status === 'PENDING' || ad.status == 'ACTIVE'"><span class="fa fa-times"></span> Finalizar</button>
                                        <button ng-if="ad.status === 'PENDING'" class="btn btn-success" ng-click="openAssign(ad)"><span class="fa fa-plus"></span> Asignar</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>

        </div>
        <!-- end advisories table -->

</div>
<!-- end fluid -->
    
    
<!-- modal -->
<div class="assign-container modal-container fadeIn" ng-show="showAssign">
    <div class="card content">
        <!-- TODO: estilizar -->
        <button ng-click="closeAssign()" class="btn-close"><span class="fa fa-times"></span> Cancelar</button>

        <!-- advisers -->
        <div class="advisers-container" ng-show="showAdvisers">
            <h2 class="title">Asesores disponibles</h2>

            <!-- loader -->
            <div class="loader" ng-show="loadingAdvisers">
                <i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i>
            </div>
            
            <!-- advisers -->
            <div class="advisers" ng-if="!loadingAdvisers">

                <!-- message -->
                <p ng-hide="advisers.length > 0">No hay asesores disponibles</p>
                
                <!-- items -->
                <div class="item" ng-repeat="ad in advisers" ng-show="advisers.length > 0" ng-click="getMatchSchedule(ad)">
                    <div class="avatar">
                        <img src="../../../../assets/img/teacher_assign.jpg" alt="">
                    </div>
                    <div class="info">
                        <span class="name">{{ad.name}}</span>
                    </div>
                </div>
                <!-- end items -->

            </div>
            <!-- end advisers -->

        </div>
        <!-- end advisers -->
        


        <!-- Horario de alumno -->
        <div class="schedule-container" ng-show="showSchedule">
            <button ng-click="backToAdvisers()" class="btn btn-primary"><span class="fa fa-arrow-left"></span> Volver</button>

            <!-- adviser -->
            <div class="selected-adviser" ng-show="selectedAdviser != null">
                <!-- items -->
                <div class="item">
                    <div class="avatar">
                        <img src="../../../../assets/img/teacher_assign.jpg" alt="">
                    </div>
                    <div class="info">
                        <a href="#!/estudiantes/{{selectedAdviser.id}}/detalle">
                            <span class="name">{{selectedAdviser.name}}</span>
                        </a>
                    </div>
                </div>
                <!-- end items -->
            </div>
            <!-- end adviser -->

            <!-- loader -->
            <div class="loader" ng-show="loadingSchedule">
                <i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i>
            </div>

            <!-- schedule -->
            <div class="schedule-container" ng-show="!loadingSchedule">
                    <button class="btn btn-success" ng-click="saveAssign()" ng-disabled="loadingAssign">Guardar</button>
                    <h2 class="title">Horario coincidente</h2>
                    <div class="schedule selectable selectable-actives">
                            
                    <div class="column-item" ng-repeat="dh in daysAndHours">
                        <div class="cell-item cell-header">{{dh.day}}</div>
                        <div ng-repeat="hour in dh.hours" class="cell-item cell-hour ng-class:checkIfExist(hour.id)"  ng-click="toggleHour($event)" data-day-number="{{dh.day_number}}" data-hour-day-id="{{hour.id}}">{{hour.hour}}</div>
                    </div>
            
                </div>
            </div>
            <!-- end schedule -->
        </div>
        <!--end  Horario de alumno -->


    </div>
</div>
<!-- end modal -->

